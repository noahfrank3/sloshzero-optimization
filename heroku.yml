build:
  docker:
    server: ./docker/Dockerfile.server
    scheduler: ./docker/Dockerfile.scheduler
    worker: ./docker/Dockerfile.worker

release:
  command:
    - dask-scheduler

run:
  web:
    image: server
    command:
      - uvicorn src.main:app --host 0.0.0.0 --port $FASTAPI_PORT
  scheduler:
    image: scheduler
    command:
      - dask-scheduler
  worker:
    image: worker
    command:
      - dask-worker --scheduler_address=$SCHEDULER_ADDRESS
